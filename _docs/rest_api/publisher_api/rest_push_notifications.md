---
title: Push-уведомления
permalink: rest_push_notifications.html
sidebar: evorest
tags: []
product: REST API
---

С помощью Облака Эвотор, вы можете передавать push-уведомления (далее также _уведомления_) на смарт-терминал.
С помощью уведомлений вы можете решать различные задачи, в зависимости от логики приложения, установленного на смарт-терминале.
Например, вы можете оповещать пользователей или передавать команды своему приложению.

## Передать push-уведомление

    POST /api/apps/{appId}/push-notifications

### Параметры запроса

Имя  | Тип  | Описание
-----|------|--------------
`devices`|`массив` | **Обязательный параметр**. Массив идентификаторов смарт-терминалов, на которые будет передано push-уведомление.
`payload`|`объект` | **Обязательный параметр**. Тело уведомления в формате JSON.
`activeUntil`|`строка` | Необязательный параметр. Задаёт время, отведённое на исполнение уведомления. По умолчанию, время исполнения уведомления составляет два дня с момента отправки. В параметре вы можете специально указать меньшее время. Время исполнения не может превышать двух дней

Пример cURL команды запроса:

```shell
curl -X POST 'https://dev.evotor.ru/apps/{application_id}/push-notifications'
-d '{"devices":["device-guid-1", "device-guid-2"],"payload":{"magic_field":123456,"magicString":"STR"}, "active_till": {timestamp}}'
-H 'Content-Type:application/json'
-H "Authorization: bearer {OAUTH_TOKEN}"
```

#### Пример тела запроса.

```json
{
  "devices": [
    "string"
  ],
  "activeUntil": "2018-05-29T14:17:32.376Z",
  "payload": {}
}
```

### Ответ

```
202 Accepted
Location: /api/apps/:app-id/push-notifications/:task-id
```
```json
{
  "details": [
    {
      "activeTill": "2018-05-29T15:44:16.111Z",
      "createdAt": "2018-05-29T15:44:16.111Z",
      "deviceId": "string",
      "rejectedAt": "2018-05-29T15:44:16.111Z",
      "reply": {},
      "sentAt": "2018-05-29T15:44:16.111Z",
      "status": "ACCEPTED"
    }
  ],
  "id": "string",
  "modifiedAt": "2018-05-29T15:44:16.111Z",
  "status": "ACCEPTED"
}
```

`id` – идентификатор задачи уведомления.

`modifiedAt` – дата и время последнего изменения задачи уведомления.

`status` – состояние уведомления. Может принимать следующие значения:

  * `ACCEPTED` – задача принята.
  * `COMPLETED` – задача выполнена.
  * `FAILED` – выполнить задачу не удалось.
  * `RUNNING` – задача выполняется.

#### Массив `details`

Массив объектов, которые содержат информацию о ходе выполнения задачи уведомления на отдельно взятом смарт-терминале.

Имя  | Тип  | Описание
-----|------|--------------
`activeTill`|`строка` | Дата и время истечения задачи уведомления.
`createdAt`|`строка` | Дата и время создания задачи уведомления.
`deviceId`|`строка` | Идентификатор смарт-терминала, на котором выполняется задача уведомления.
`rejectedAt`|`строка` | Дата и время, когда задача уведомления была отклонена сервером.
`reply`|`объект` | Ответ приложения на уведомление в формате JSON.
`sentAt`|`строка` | Дата и время отправки уведомления на смарт-терминал.
`status`|`строка` | Состояние задачи уведомления на смарт-терминале. Возможные значения: `ACCEPTED`(принято), `DELIVERED`(доставлено), `EXPIRED`(истекло, достигнуто время `activeTill`), `REJECTED` (отклонено сервером), `UNKNOWN` (неизвестная ошибка).

## Получить push-уведомление

    GET /api/apps/{appId}/push-notifications/{pushId}

### Ответ

```
200 OK
```
```json
{
  "details": [
    {
      "activeTill": "2018-05-29T16:11:31.079Z",
      "createdAt": "2018-05-29T16:11:31.079Z",
      "deviceId": "string",
      "rejectedAt": "2018-05-29T16:11:31.079Z",
      "reply": {},
      "sentAt": "2018-05-29T16:11:31.079Z",
      "status": "ACCEPTED"
    }
  ],
  "id": "string",
  "modifiedAt": "2018-05-29T16:11:31.079Z",
  "status": "ACCEPTED"
}
```
