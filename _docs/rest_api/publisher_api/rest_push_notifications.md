---
title: Push-уведомления
permalink: rest_push_notifications.html
sidebar: evorest
tags: []
product: REST API
---

С помощью Облака Эвотор, вы можете передавать push-уведомления (далее также _уведомления_) на смарт-терминал.
С помощью уведомлений вы можете решать различные задачи, в зависимости от логики приложения, установленного на смарт-терминале.
Например, вы можете оповещать пользователей или передавать команды своему приложению.

## Передать push-уведомление

    POST /api/apps/{app-id}/push-notifications

### Параметры запроса

Имя  | Тип  | Описание
-----|------|--------------
`devices`| `array` | **Обязательный**. Массив идентификаторов смарт-терминалов, на которые будет передано push-уведомление.
`payload`| `object` | **Обязательный**. Тело уведомления в формате JSON.
`active_until`| `string` | Задаёт время, отведённое на исполнение уведомления. По умолчанию, время исполнения уведомления составляет два дня с момента отправки. В параметре вы можете специально указать меньшее время. Время исполнения не может превышать двух дней.

Пример cURL команды запроса:

```shell
curl -X POST 'https://dev.evotor.ru/apps/{application_id}/push-notifications'
-d '{"devices":["device-guid-1", "device-guid-2"],"payload":{"magic_field":123456,"magicString":"STR"}, "active_till": {timestamp}}'
-H 'Content-Type:application/json'
-H "Authorization: bearer {OAUTH_TOKEN}"
```

#### Пример тела запроса.

```json
{
  "devices": [
    "string"
  ],
  "active_until": "2018-05-29T14:17:32.376Z",
  "payload": {}
}
```

### Ответ

```
202 Accepted
Location: /api/apps/:app-id/push-notifications/:task-id
```
```json
{
  "details": [
    {
      "active_till": "2018-05-29T15:44:16.111Z",
      "created_at": "2018-05-29T15:44:16.111Z",
      "device_id": "string",
      "rejected_at": "2018-05-29T15:44:16.111Z",
      "reply": {},
      "sent_at": "2018-05-29T15:44:16.111Z",
      "status": "ACCEPTED"
    }
  ],
  "id": "string",
  "modified_at": "2018-05-29T15:44:16.111Z",
  "status": "ACCEPTED"
}
```

`id` – идентификатор задачи уведомления.

`modified_at` – дата и время последнего изменения задачи уведомления.

`status` – состояние уведомления. Может принимать следующие значения:

  * `ACCEPTED` – задача принята.
  * `COMPLETED` – задача выполнена.
  * `FAILED` – выполнить задачу не удалось.
  * `RUNNING` – задача выполняется.

#### Массив `details`

Массив объектов, которые содержат информацию о ходе выполнения задачи уведомления на отдельно взятом смарт-терминале.

Имя  | Тип  | Описание
-----|------|--------------
`active_till`| `string` | Дата и время истечения задачи уведомления.
`created_at`| `string` | Дата и время создания задачи уведомления.
`device_id`| `string` | Идентификатор смарт-терминала, на котором выполняется задача уведомления.
`rejected_at`| `string` | Дата и время, когда задача уведомления была отклонена сервером.
`reply`| `object` | Ответ приложения на уведомление в формате JSON.
`sent_at`| `string` | Дата и время отправки уведомления на смарт-терминал.
`status`| `string` | Состояние задачи уведомления на смарт-терминале. Возможные значения: `ACCEPTED`(принято), `DELIVERED`(доставлено), `EXPIRED`(истекло, достигнуто время `active_till`), `REJECTED` (отклонено сервером), `UNKNOWN` (неизвестная ошибка).

## Получить push-уведомление

    GET /api/apps/{appId}/push-notifications/{push-id}

### Ответ

```
200 OK
```
```json
{
  "details": [
    {
      "active_till": "2018-05-29T16:11:31.079Z",
      "created_at": "2018-05-29T16:11:31.079Z",
      "device_id": "string",
      "rejected_at": "2018-05-29T16:11:31.079Z",
      "reply": {},
      "sent_at": "2018-05-29T16:11:31.079Z",
      "status": "ACCEPTED"
    }
  ],
  "id": "string",
  "modified_at": "2018-05-29T16:11:31.079Z",
  "status": "ACCEPTED"
}
```
